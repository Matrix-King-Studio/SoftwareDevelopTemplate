# {{PROJECT_NAME}} 测试环境 Docker Compose 配置
#
# 占位符说明：
#   {{DOCKER_NAMESPACE}} - 镜像命名空间
#
# 环境变量说明：
#   使用 ${VAR:-default} 格式，支持通过环境变量覆盖默认值
#   MYSQL_* - MySQL 数据库连接配置
#   REDIS_* - Redis 连接配置

version: "3"
services:
  django:
    image: registry.cn-hangzhou.aliyuncs.com/matrix-studio/{{DOCKER_NAMESPACE}}:test
    command: sh django-entrypoint-test.sh
    networks:
      - {{DOCKER_NAMESPACE}}-net
    ports:
      - "8004:8000"
    volumes:
      - ./log:/usr/local/var/log
      - ./media:/app/Backend/media
    environment:
      - MYSQL_NAME=${MYSQL_NAME:-your_test_db_name}
      - MYSQL_USER=${MYSQL_USER:-your_test_db_user}
      - MYSQL_PASSWORD=${MYSQL_PASSWORD:-your_test_db_password}
      - MYSQL_HOST=${MYSQL_HOST:-your_test_db_host}
      - MYSQL_PORT=${MYSQL_PORT:-3306}
      - REDIS_HOST=${REDIS_HOST:-your_test_redis_host}
      - REDIS_PORT=${REDIS_PORT:-6379}
      - REDIS_DB=${REDIS_DB:-2}
      - REDIS_PASSWORD=${REDIS_PASSWORD:-your_test_redis_password}
    restart: always

networks:
  {{DOCKER_NAMESPACE}}-net:
    driver: bridge
